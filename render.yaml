services:
  # Сервис для нашего бота, работающий в нативной среде Python
  - type: worker
    name: cryptobot
    runtime: python
    plan: starter # Starter плана достаточно для этой конфигурации
    region: frankfurt
    
    # ИСПРАВЛЕНИЕ: Убираем команду playwright install.
    # Теперь мы только устанавливаем зависимости из requirements.txt
    buildCommand: "pip install --upgrade pip && pip install -r requirements.txt"
    
    startCommand: "python -m bot.main"
    
    envVars:
      - key: PYTHON_VERSION
        value: 3.11
      - key: BOT_TOKEN
        fromSecret: true
      - key: REDIS_URL
        fromSecret: true
      - key: ADMIN_CHAT_ID
        fromSecret: true
      - key: NEWS_CHAT_ID
        fromSecret: true
      - key: CMC_API_KEY
        fromSecret: true
      - key: OPENAI_API_KEY
        fromSecret: true