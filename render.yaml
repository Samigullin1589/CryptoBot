services:
  # Этот сервис будет нашим ботом, запущенным в Docker
  - type: worker
    name: cryptobot
    # Указываем, что среда выполнения - Docker
    env: docker
    plan: pro
    
    # Указываем путь к нашему Dockerfile
    dockerfilePath: ./Dockerfile
    
    # buildCommand и startCommand больше не нужны, они определены в Dockerfile
    
    envVars:
      - key: BOT_TOKEN
        fromSecret: true
      - key: REDIS_URL
        fromService:
          type: redis
          name: cryptobot-redis
          property: connectionString
      - key: ADMIN_CHAT_ID
        fromSecret: true
      - key: NEWS_CHAT_ID
        fromSecret: true
      - key: CMC_API_KEY
        fromSecret: true
      - key: OPENAI_API_KEY
        fromSecret: true

  # Этот сервис - наша база данных Redis
  - type: redis
    name: cryptobot-redis
    plan: free